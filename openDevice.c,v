head	1.8;
access;
symbols;
locks
	root:1.8; strict;
comment	@ * @;


1.8
date	2022.08.12.23.58.49;	author root;	state Exp;
branches;
next	1.7;

1.7
date	2022.08.11.15.30.01;	author root;	state Exp;
branches;
next	1.6;

1.6
date	2022.08.11.11.56.08;	author root;	state Exp;
branches;
next	1.5;

1.5
date	2022.08.11.11.55.08;	author root;	state Exp;
branches;
next	1.4;

1.4
date	2022.08.09.19.12.06;	author root;	state Exp;
branches;
next	1.3;

1.3
date	2022.08.09.19.05.28;	author root;	state Exp;
branches;
next	1.2;

1.2
date	2022.08.09.16.14.44;	author root;	state Exp;
branches;
next	1.1;

1.1
date	2022.08.09.15.45.53;	author root;	state Exp;
branches;
next	;


desc
@@


1.8
log
@*** empty log message ***
@
text
@#include "headers.h"
#include "declarations.h"

int openDevice(struct inode *inodep,struct file *filep)
{
	Dev *ldev;
	int ret;
#ifdef DEBUG
	printk(KERN_INFO "%s: Begin\n",__func__);
#endif      
	ldev = container_of(inodep->i_cdev, Dev, c_dev);
	if(!ldev)
	{
		printk(KERN_ERR "%s: ERROR: conttainer_of() failure.\n",__func__);
		goto OUT;
	}

	if((filep->f_flags & O_ACCMODE) == O_WRONLY)    // check mode of device read or write
	{
                ret = trimDevice(ldev);
	        if(ret == -1)
	        {
			printk(KERN_ERR "%s: ERROR: Trim Device failure.\n",__func__);
			goto OUT;
		}
	}
       
        filep->private_data = ldev;

#ifdef DEBUG
	printk(KERN_INFO "%s: End\n",__func__);
#endif      
	return 0;
OUT:
#ifdef DEBUG
	printk(KERN_INFO "%s: ERROR: Error with End\n",__func__);
#endif      
	return -1;
}
@


1.7
log
@*** empty log message ***
@
text
@d18 1
a18 1
	if((filep->f_flags & O_ACCMODE) == O_WRONLY)
@


1.6
log
@*** empty log message ***
@
text
@d27 2
@


1.5
log
@*** empty log message ***
@
text
@d7 1
@


1.4
log
@typo
@
text
@d16 11
@


1.3
log
@use contauner of to accesse IO and Apllication memory by 
kernal space pointer.
@
text
@d4 1
a4 1
int openDevice(struct inode *,struct file *)
d10 1
a10 1
	ldev = container_of(inode->cdev, Dev, c_dev);
@


1.2
log
@*** empty log message ***
@
text
@d6 1
d10 6
a15 2


d20 5
@


1.1
log
@Initial revision
@
text
@a2 1
#include "fileopr.h"
@
